"use strict";angular.module("loanAdvisorApp",["ngAnimate","ngRoute","ngTouch","ngMaterial","firebase","angular-chartist"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/login.html",controller:"LoginCtrl"}).when("/home",{templateUrl:"views/home.html",controller:"HomeCtrl"}).when("/loanlist/:loanType",{templateUrl:"views/loanlist.html",controller:"LoanlistCtrl"}).when("/loanlist/:loanType/loanId/:loanID",{templateUrl:"views/loandetails.html",controller:"LoandetailsCtrl"}).when("/loanlist/:loanType/compare",{templateUrl:"views/compare.html",controller:"ComparisonCtrl"}).when("/emicalc",{templateUrl:"views/emicalculator.html",controller:"EMIcalCtrl"}).otherwise({redirectTo:"/"})}]).directive("toolbar",function(){return{restrict:"E",controller:["$scope","$location","$window","$mdSidenav",function(a,b,c,d){var e=b.path();a.pageProps=e.indexOf("loanId")>0?{title:"Loan Details",goBack:!0}:e.indexOf("loanlist")>0?e.indexOf("compare")>0?{title:"Compare Loans",goBack:!0}:e.indexOf("home")>0?{title:"Home Loans"}:e.indexOf("auto")>0?{title:"Auto Loans"}:{title:"Personal Loans"}:e.indexOf("home")>0?{title:"Loan Smart"}:{title:"EMI Calculator",goBack:!0},a.toggleLeft=function(){d("left").toggle()},a.goTo=function(a){var c="emicalc"===a?"/emicalc":"/loanlist/"+a;b.path(c)},a.back=function(){c.history.back()}}],link:function(a,b){"Loan Smart"===a.pageProps.title&&b.find("md-toolbar").removeClass("md-whiteframe-z1")},templateUrl:"views/partials/toolbar.html"}}).factory("sharedProps",["$http","$q",function(a,b){var c={},d="data/data.json";return c.getLoans=function(){var c=b.defer(),e=a.get(d);return e.then(function(a){c.resolve(a)},function(a){c.reject(a)}),c.promise},c.calculateEMI=function(a,b,c){return Math.round(a*b*(1/(1-1/Math.pow(1+b,c))))},c}]),angular.module("loanAdvisorApp").controller("LoginCtrl",["$scope","$location","$q","$mdToast","Auth",function(a,b,c,d,e){a.user={email:"",password:""},a.authObj=e,a.signIn=function(){a.loginForm.$valid&&a.tryLogIn().then(function(b){a.showSimpleToast("Signed in as "+b.password.email),a.goHome()},function(b){"INVALID_USER"===b.code?a.createUser().then(function(){a.signIn()}):"INVALID_PASSWORD"===b.code?(a.showSimpleToast("Incorrect Password!"),a.user.password=""):(a.showSimpleToast("Invalid Email ID!"),console.error(b),a.user.email="",a.user.password="")})},a.goHome=function(){b.path("/home")},a.tryLogIn=function(){var b=c.defer(),d=a.authObj.$authWithPassword({email:a.user.email,password:a.user.password});return d.then(function(a){b.resolve(a)}).catch(function(a){b.reject(a)}),b.promise},a.createUser=function(){return a.authObj.$createUser(a.user.email,a.user.password)},a.showSimpleToast=function(a){d.show(d.simple().content(a).position("bottom fit").hideDelay(5e3))}}]).factory("Auth",["$firebaseAuth",function(a){var b=new Firebase("https://amber-torch-5533.firebaseio.com/");return a(b)}]),angular.module("loanAdvisorApp").controller("HomeCtrl",["$scope","$location",function(a,b){a.goTo=function(a){b.path("/loanlist/"+a)}}]),angular.module("loanAdvisorApp").controller("LoanlistCtrl",["$scope","$rootScope","$location","$routeParams","sharedProps",function(a,b,c,d,e){a.loans,a.compareLoans=[],a.isChecked=!1,e.getLoans().then(function(b){a.loans=b.data}),a.userPref={principal:void 0===b.principal?"2500000":b.principal,time:void 0===b.time?"15":b.time},a.tempPref={principal:a.userPref.principal,time:a.userPref.time},a.update=function(){a.userPref.principal=a.tempPref.principal,a.userPref.time=a.tempPref.time},a.openDetails=function(d){b.principal=a.userPref.principal,b.time=a.userPref.time,b.loan=d,c.path(c.path()+"/loanId/"+d.id)},a.initial=function(a){return a.charAt(0)},a.EMI=function(b){var c=a.userPref.principal,d=b/1200,f=12*a.userPref.time;return e.calculateEMI(c,d,f)},a.checkCount=function(){var b=[];angular.forEach(a.loans,function(a){a.selected&&b.push(a)}),a.isChecked=angular.isArray(b)&&b.length>0?!0:!1,a.compareLoans=b},a.compare=function(){b.compareLoans=a.compareLoans,b.principal=a.userPref.principal,b.time=a.userPref.time,c.path(c.path()+"/compare")}}]),angular.module("loanAdvisorApp").controller("LoandetailsCtrl",["$scope","$rootScope","$routeParams","sharedProps",function(a,b,c,d){a.loan=b.loan,a.principal=b.principal,a.time=b.time,a.initial=function(a){return a.charAt(0)},a.EMI=function(b){var c=a.principal,e=a.loan.rate/1200,f=12*(b||a.time);return d.calculateEMI(c,e,f)},a.netInterest=function(b){return b=b||a.time,a.EMI(b)*b*12-a.principal},a.netPayable=function(){return a.loan.processingFee?parseInt(a.netInterest())+parseInt(a.principal)+parseInt(a.loan.processingFee*a.principal/100):parseInt(a.netInterest())+parseInt(a.principal)},a.events={draw:function(a){"label"===a.type&&"x"===a.axis&&a.element.attr({dx:a.x+a.space/2})}},a.barData={labels:[0,0,0,0,0],series:[[0,0,0,0,0]]},a.barOptions={axisX:{showGrid:!1},axisY:{labelInterpolationFnc:function(a){return a/1e5+"L"}}};var e=function(b){return b=parseInt(b||a.time),5===b?[b,b+5,b+10,b+15,b+20]:10===b?[b-5,b,b+5,b+10,b+15]:[b-10,b-5,b,b+5,b+10]};angular.forEach(e(),function(b){console.log(b),a.barData.series.forEach(function(c){c.push(a.netInterest(b)),c.splice(0,1)}),a.barData.labels.push(b+" yrs"),a.barData.labels.splice(0,1)}),a.Amortize=function(){for(var b,c,e,f=a.principal,g=a.loan.rate/1200,h=12*a.time,i=d.calculateEMI(f,g,h),j=0;h>j;j++)b=f*g,c=i-b,e=f-c,f=e}}]),angular.module("loanAdvisorApp").controller("ComparisonCtrl",["$scope","$rootScope","$location","sharedProps",function(a,b,c,d){a.loans=b.compareLoans,a.principal=b.principal,a.time=b.time,a.initial=function(a){return a.charAt(0)},a.openDetails=function(a){b.loan=a,c.path(c.path().replace("compare","loanId/"+a.id))},a.EMI=function(b){var c=a.principal,e=b/1200,f=12*a.time;return d.calculateEMI(c,e,f)},a.netInterest=function(b){return a.EMI(b)*a.time*12-a.principal}}]),angular.module("ngLocale",[],["$provide",function(a){function b(a){a+="";var b=a.indexOf(".");return-1==b?0:a.length-b-1}function c(a,c){var d=c;void 0===d&&(d=Math.min(b(a),3));var e=Math.pow(10,d),f=(a*e|0)%e;return{v:d,f:f}}var d={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};a.value("$locale",{DATETIME_FORMATS:{AMPMS:["am","pm"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fullDate:"EEEE d MMMM y",longDate:"d MMMM y",medium:"dd-MMM-y h:mm:ss a",mediumDate:"dd-MMM-y",mediumTime:"h:mm:ss a","short":"dd/MM/yy h:mm a",shortDate:"dd/MM/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"₹",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:2,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:2,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"¤-",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-in",pluralCat:function(a,b){var e=0|a,f=c(a,b);return 1==e&&0==f.v?d.ONE:d.OTHER}})}]);
